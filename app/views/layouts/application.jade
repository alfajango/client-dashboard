doctype 5
html
  head
    title= title
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js')
    link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css')
    //link(rel='stylesheet', href='/vendor/datepicker/css/datepicker.css')
    script(src='/socket.io/socket.io.js')
    script(src='/javascripts/jquery-1.7.2.min.js')
    script(src='/vendor/bootstrap/js/bootstrap.min.js')
    script(src='/vendor/humane.js')
    script(src='/vendor/datepicker/js/bootstrap-datepicker.js')
    script(src='/vendor/flot/js/jquery.flot.js')
    script(src='/vendor/flot/js/jquery.flot.stack.js')
    script(src='/vendor/flot/js/jquery.flot.time.js')
    script(src='/vendor/flot/js/jquery.flot.crosshair.js')
    script(src='/vendor/flot/js/jquery.flot.pie.js')
    // Android web app tags
    meta(name="mobile-web-app-capable", content="yes")
    link(rel="shortcut icon", sizes="192x192", href="/images/mobile-icon-192x192.png")
    // Apple web app tags
    link(rel="apple-touch-icon", sizes="192x192", href="/images/mobile-icon-192x192.png")
    meta(name="apple-mobile-web-app-capable", content="yes")
    meta(name="apple-mobile-web-app-status-bar-style", content="black-translucent")

    block head

    if analytics_account
      script(type="text/javascript")

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', '#{analytics_account}']);
        _gaq.push(['_setDomainName', 'alfajango.com']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    - if (typeof(project) != 'undefined' && project)
      style
        .header {
          background-color: #{project.headerBG};
          color: #{project.headerColor};
        }
        .navbar .navbar-inner {
          background-color: #{project.navbarBG};
        }
        .navbar a.brand, .navbar .nav > li > a, .navbar .nav > li > a:hover {
          color: #{project.headerBG} !important;
        }
        .navbar a.brand, .navbar .nav > li > a > b.caret {
          border-top-color: #{project.headerBG} !important;
        }

      script
        var widgets = {};
      each service in project.services
        script(src="/widgets/#{service.name}")

  body
    - if (typeof(iframe) === 'undefined' || !iframe)
      .navbar.navbar-expand-md.navbar-dark.sticky-top.bg-dark
        .container
          .d-flex.flex-grow-1
            a.navbar-brand(href=(currentUser.admin ? "/admin" : "/")) Tech Dashboard by Alfa Jango
            .w-100.text-right.justify-content-end
              button.navbar-toggler('data-bs-toggle'='collapse','data-bs-target'='#nav-menu-collapsible', 'aria-controls'='nav-menu-collapsible')
                span.navbar-toggler-icon
          #nav-menu-collapsible.collapse.navbar-collapse.me-auto.flex-grow-1.justify-content-end
            ul.navbar-nav
              if currentUser.admin
                li.nav-item.dropdown
                  a.nav-link.text-white.dropdown-toggle#dropdown-select-client(href="#", 'data-bs-toggle'='dropdown')
                    | Select Client
                  ul.dropdown-menu('aria-labelledby'='dropdown-select-client')
                    each client in clients
                      - if (client.projects && client.projects[0])
                        - bgColor = client.projects[0].headerBG
                        - hdColor = client.projects[0].headerColor

                        li(style="background: #{bgColor};")
                          a.dropdown-item(href="/?client_id=#{client.id}", style="color: #{hdColor};")
                            = client.name
                li.nav-item.dropdown
                  a.nav-link.text-white.dropdown-toggle#dropdown-admin(href="#", 'data-bs-toggle'='dropdown')
                    | Admin
                  ul.dropdown-menu('aria-labelledby'='dropdown-admin')
                    li
                      a.dropdown-item(href="/admin")
                        i.icon-wrench
                        |  Manage / Settings
                    li
                      a.dropdown-item(href="/admin/clients/new")
                        i.icon-plus
                        |  Create Client
                    li
                      a.dropdown-item(href="/admin/users/new")
                        i.icon-plus
                        |  Create User
              if currentUser.id
                li.nav-item
                  a.nav-link.text-white(href='/change_password') Change Password
                li.nav-item
                  a.nav-link.text-white(href='/logout') Logout
          block menu

      .header
        .container
          block header

    .main-content
      div.container
        - if (message)
          - for(msg in message)
            .alert(class="alert-#{msg}")= message[msg]
        block content
