extends ../layouts/application

block content
  h1 Admin

  a.btn(href="/admin/clients/new")
    i.icon-plus
    Add Client
  a.btn(href="/admin/users/new")
    i.icon-plus
    Add User

  table.table.table-bordered
    tr
      th Client
      th Projects
      th Users
    each client in clients
      tr
        td
          a(href="/?client_id=#{client.id}")= client.name
          a.btn.btn-mini(href="/admin/clients/#{client.id}/edit") Edit

        td
          - if (client.projects)
            ul
              - for project in client.projects
                li
                  = project.name
                  | -
                  a.btn.btn-mini(href="/admin/clients/#{client.id}/projects/#{project._id}/edit") Edit

                  - if (project.services)
                    ul
                      - for service in project.services
                        li
                          = service.name
                          | -
                          a.btn.btn-mini(href="/admin/clients/#{client.id}/projects/#{project.id}/services/#{service.id}/edit") Edit

        td
          - if (users[client.id])
            ul
              - for user in users[client.id]
                li
                  = user.email
                  | -
                  a.btn.btn-mini(href="/admin/users/#{user.id}/edit") Edit

  - if (users['not assigned'])
    h2 Unassigned Users
    ul
      - for user in users['not assigned']
        li
          = user.email
          | -
          a.btn.btn-mini(href="/admin/users/#{user.id}/edit") Edit

